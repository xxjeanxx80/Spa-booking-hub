<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Owner Dashboard â€“ Beautiful Care</title>
  <meta name="description" content="Owner dashboard for managing multi-spa: services, staff, bookings, reviews, coupons" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/owner-dashboard.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>window.REQUIRED_ROLES = ['owner'];</script>
  <script type="module" src="js/guard.js"></script>
</head>
<body>
  <div id="app-header"></div>
  <script type="module">
    import { renderHeader } from './js/ui.js';
    renderHeader();
  </script>
  <!-- Topbar -->
  <div class="topbar">
    <div class="topwrap">
      <div class="brand"><div class="brand-logo"></div> Beautiful Care â€“ Owner</div>
      <div class="spa-switch">
        <span class="muted">Spa cá»§a tÃ´i:</span>
        <select class="select" id="spaSelect"></select>
        <button class="btn ghost" id="btnAddSpa">+ ThÃªm spa</button>
        <button class="btn primary" id="btnToggleStatus">Táº¡m nghá»‰</button>
        <button class="btn ghost" id="btnLogout">ÄÄƒng xuáº¥t</button>
      </div>
    </div>
  </div>

  <div class="layout">
    <!-- Sidebar -->
    <aside class="side">
      <h4>Quáº£n trá»‹</h4>
      <nav class="nav" id="sideNav">
        <button data-tab="dashboard" class="active">ğŸ  Dashboard</button>
        <button data-tab="calendar">ğŸ“… Lá»‹ch</button>
        <button data-tab="bookings">ğŸ§¾ Bookings</button>
        <button data-tab="services">ğŸ’… Dá»‹ch vá»¥</button>
        <button data-tab="staff">ğŸ‘©â€ğŸ”§ NhÃ¢n viÃªn</button>
        <button data-tab="reviews">â­ Reviews</button>
        <button data-tab="customers">ğŸ‘¥ KhÃ¡ch hÃ ng</button>
        <button data-tab="coupons">ğŸŸï¸ Coupons</button>
        <button data-tab="settings">âš™ï¸ CÃ i Ä‘áº·t Spa</button>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="content">
      <!-- HERO / STATUS -->
      <section class="hero">
        <div class="cover"></div>
        <div class="in">
          <div style="flex:1 1 auto">
            <div style="font-size:24px;font-weight:800" id="spaName">â€”</div>
            <div class="muted" id="spaAddr">â€”</div>
          </div>
          <span id="spaStatus" class="badge live">Äang hoáº¡t Ä‘á»™ng</span>
          <div class="tag">Tá»•ng sá»‘ spa sá»Ÿ há»¯u: <strong id="spaCount" style="margin-left:6px">0</strong></div>
        </div>
      </section>

      <!-- DASHBOARD TAB -->
      <section id="tab-dashboard">
        <div class="cards">
          <div class="card"><h3>Doanh thu thÃ¡ng nÃ y</h3><div class="metric" id="mRevenue">â€”</div></div>
          <div class="card"><h3>Lá»£i nhuáº­n thÃ¡ng nÃ y</h3><div class="metric" id="mProfit">â€”</div></div>
          <div class="card"><h3>Booking (thÃ¡ng)</h3><div class="metric" id="mBookings">â€”</div></div>
          <div class="card"><h3>KhÃ¡ch quay láº¡i</h3><div class="metric" id="mReturning">â€”</div></div>
        </div>
        <div class="panel">
          <div class="toolbar"><h3>Doanh thu & Lá»£i nhuáº­n theo thÃ¡ng</h3></div>
          <canvas id="chartRevenue" height="90"></canvas>
        </div>
        <div class="panel" style="display:grid;grid-template-columns:1.2fr .8fr;gap:14px">
          <div>
            <h3>Top dá»‹ch vá»¥</h3>
            <table id="tblTopServices"><thead><tr><th>Dá»‹ch vá»¥</th><th>ÄÆ¡n</th><th>Doanh thu</th></tr></thead><tbody></tbody></table>
          </div>
          <div>
            <h3>Hiá»‡u suáº¥t nhÃ¢n viÃªn</h3>
            <table id="tblStaffPerf"><thead><tr><th>NhÃ¢n viÃªn</th><th>ÄÆ¡n</th><th>Rating TB</th></tr></thead><tbody></tbody></table>
          </div>
        </div>
      </section>

      <!-- CALENDAR TAB -->
      <section id="tab-calendar" style="display:none">
        <div class="panel">
          <div class="toolbar">
            <h3>Lá»‹ch tuáº§n</h3>
            <div class="actions">
              <button class="btn ghost" id="prevWeek">â—€</button>
              <button class="btn ghost" id="nextWeek">â–¶</button>
            </div>
          </div>
          <div class="calendar" id="calendar"></div>
        </div>
      </section>

      <!-- BOOKINGS TAB -->
      <section id="tab-bookings" style="display:none">
        <div class="panel">
          <div class="toolbar">
            <h3>Quáº£n lÃ½ Ä‘áº·t lá»‹ch</h3>
            <input class="input" placeholder="TÃ¬m theo tÃªn/Ä‘iá»‡n thoáº¡i..." id="searchBooking" />
          </div>
          <table id="tblBookings"><thead><tr><th>KhÃ¡ch</th><th>Dá»‹ch vá»¥</th><th>Thá»i gian</th><th>GiÃ¡</th><th>Tráº¡ng thÃ¡i</th><th>HÃ nh Ä‘á»™ng</th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- SERVICES TAB -->
      <section id="tab-services" style="display:none">
        <div class="panel">
          <div class="toolbar">
            <h3>Dá»‹ch vá»¥ cá»§a spa</h3>
            <div class="actions"><button class="btn primary" id="btnAddService">+ ThÃªm dá»‹ch vá»¥</button></div>
          </div>
          <table id="tblServices"><thead><tr><th>TÃªn dá»‹ch vá»¥</th><th>Thá»i lÆ°á»£ng</th><th>GiÃ¡</th><th></th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- STAFF TAB -->
      <section id="tab-staff" style="display:none">
        <div class="panel">
          <div class="toolbar">
            <h3>NhÃ¢n viÃªn</h3>
            <button class="btn primary" id="btnAddStaff">+ ThÃªm nhÃ¢n viÃªn</button>
          </div>
          <table id="tblStaff"><thead><tr><th>TÃªn</th><th>Ká»¹ nÄƒng</th><th>Tráº¡ng thÃ¡i</th><th></th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- REVIEWS TAB -->
      <section id="tab-reviews" style="display:none">
        <div class="panel">
          <div class="toolbar"><h3>ÄÃ¡nh giÃ¡ tá»« khÃ¡ch hÃ ng</h3></div>
          <table id="tblReviews"><thead><tr><th>KhÃ¡ch</th><th>Rating</th><th>Ná»™i dung</th><th>NgÃ y</th><th>HÃ nh Ä‘á»™ng</th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- CUSTOMERS TAB -->
      <section id="tab-customers" style="display:none">
        <div class="panel">
          <div class="toolbar"><h3>KhÃ¡ch hÃ ng & Loyalty</h3></div>
          <table id="tblCustomers"><thead><tr><th>TÃªn</th><th>SÄT</th><th>Láº§n Ä‘áº·t</th><th>Háº¡ng</th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- COUPONS TAB -->
      <section id="tab-coupons" style="display:none">
        <div class="panel">
          <div class="toolbar"><h3>MÃ£ Æ°u Ä‘Ã£i</h3><button class="btn primary" id="btnAddCoupon">+ Táº¡o mÃ£</button></div>
          <table id="tblCoupons"><thead><tr><th>MÃ£</th><th>Loáº¡i</th><th>GiÃ¡ trá»‹</th><th>Hiá»‡u lá»±c</th><th></th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- SETTINGS TAB -->
      <section id="tab-settings" style="display:none">
        <div class="panel">
          <h3>ThÃ´ng tin Spa</h3>
          <div class="grid2">
            <label>TÃªn spa<input class="input" id="inpSpaName"></label>
            <label>Tráº¡ng thÃ¡i<select class="select" id="selSpaStatus"><option value="active">Äang hoáº¡t Ä‘á»™ng</option><option value="paused">Táº¡m nghá»‰</option></select></label>
            <label>Äá»‹a chá»‰<textarea class="input" id="inpSpaAddr" rows="3"></textarea></label>
            <label>Sá»‘ Ä‘iá»‡n thoáº¡i<input class="input" id="inpSpaPhone"></label>
          </div>
          <div class="actions" style="margin-top:10px"><button class="btn primary" id="btnSaveSpa">LÆ°u thay Ä‘á»•i</button><button class="btn ghost" id="btnDeleteSpa">XÃ³a spa</button></div>
          <p class="muted" style="margin-top:8px">Sau khi lÆ°u, há»‡ thá»‘ng sáº½ gá»­i <strong>thÃ´ng bÃ¡o cho Admin</strong> Ä‘á»ƒ kiá»ƒm duyá»‡t (tham kháº£o mÃ´ táº£).</p>
        </div>
      </section>
    </main>
  </div>

  <script>
  // ======= MOCK DATA (thay báº±ng API backend sau) =======
  const db = {
    spas:[
      {id:1,name:'Aki Beauty Spa', status:'active', address:'301 Äá»™i Cáº¥n, Ba ÄÃ¬nh, HÃ  Ná»™i', phone:'096 790 0530'},
      {id:2,name:'NÃ ng Charming', status:'paused', address:'207 HoÃ ng Cáº§u, Äá»‘ng Äa, HÃ  Ná»™i', phone:'098 222 0000'}
    ],
    services:{1:[
      {id:11,name:'Massage Viá»‡t Nam cá»• truyá»n', duration:60, price:600000},
      {id:12,name:'Massage Shiatsu Nháº­t Báº£n', duration:60, price:750000},
      {id:13,name:'Massage Ä‘Ã¡ nÃ³ng', duration:60, price:750000}
    ],2:[{id:21,name:'Gá»™i Ä‘áº§u dÆ°á»¡ng sinh', duration:45, price:250000}]},
    staff:{1:[
      {id:101,name:'Lan', skills:'Massage, Shiatsu', active:true, rating:4.8, orders:120},
      {id:102,name:'Mai', skills:'Massage Ä‘Ã¡ nÃ³ng', active:true, rating:4.6, orders:98},
      {id:103,name:'Huyá»n', skills:'Facial', active:false, rating:4.5, orders:40}
    ],2:[{id:201,name:'ThÃºy', skills:'Hair wash', active:true, rating:4.7, orders:60}]},
    bookings:{1:[
      {id:5001, customer:'Nguyá»…n An', phone:'0901', service:'Shiatsu Nháº­t Báº£n', time:'2025-09-18 10:00', price:750000, status:'pending'},
      {id:5002, customer:'Tráº§n VÅ©', phone:'0902', service:'VN cá»• truyá»n', time:'2025-09-18 11:30', price:600000, status:'confirmed'},
      {id:5003, customer:'Pháº¡m Hoa', phone:'0903', service:'ÄÃ¡ nÃ³ng', time:'2025-09-18 14:00', price:750000, status:'completed'}
    ],2:[{id:6001, customer:'Minh', phone:'0904', service:'DÆ°á»¡ng sinh', time:'2025-09-19 09:30', price:250000, status:'pending'}]},
    reviews:{1:[
      {id:9001, name:'An', rating:5, text:'Ráº¥t thÆ° giÃ£n!', date:'2025-09-10'},
      {id:9002, name:'Hoa', rating:4, text:'NhÃ¢n viÃªn thÃ¢n thiá»‡n', date:'2025-09-12'}
    ],2:[{id:9003,name:'BÃ¬nh', rating:3, text:'á»”n', date:'2025-09-14'}]},
    customers:{1:[
      {name:'An', phone:'0901', count:6, rank:'gold'},
      {name:'VÅ©', phone:'0902', count:3, rank:'member'},
      {name:'Hoa', phone:'0903', count:10, rank:'diamond'}
    ],2:[{name:'Minh', phone:'0904', count:2, rank:'member'}]},
    coupons:{1:[{code:'AKI10', type:'percent', value:10, range:'01-30/09'}],2:[{code:'NC20', type:'percent', value:20, range:'15-30/09'}]},
    revenue:{1:{months:["01","02","03","04","05","06","07","08","09","10","11","12"], rev:[40,46,50,55,60,64,70,80,88,0,0,0], prof:[18,20,22,24,26,28,30,36,40,0,0,0]}, 2:{months:["01","02","03","04","05","06","07","08","09","10","11","12"], rev:[12,14,16,18,20,22,26,28,30,0,0,0], prof:[5,6,7,8,9,10,12,13,14,0,0,0]}}
  };

  let currentSpaId = db.spas[0].id;

  // ======= INIT =======
  const spaSelect = document.getElementById('spaSelect');
  function refreshSpaOptions(){
    spaSelect.innerHTML = db.spas.map(s=>`<option value="${s.id}">${s.name}</option>`).join('');
    document.getElementById('spaCount').textContent = db.spas.length;
    spaSelect.value = currentSpaId;
  }

  function fmtMoney(v){return new Intl.NumberFormat('vi-VN').format(v)+" VND"}

  function populateDashboard(){
    const spa = db.spas.find(s=>s.id==currentSpaId);
    document.getElementById('spaName').textContent = spa.name;
    document.getElementById('spaAddr').textContent = spa.address;
    const badge = document.getElementById('spaStatus');
    if (spa.status==='active'){badge.textContent='Äang hoáº¡t Ä‘á»™ng';badge.className='badge live'} else {badge.textContent='Táº¡m nghá»‰';badge.className='badge pause'}

    const stat = db.revenue[currentSpaId];
    const revThis = stat.rev[8]||0; // thÃ¡ng 9
    const profThis = stat.prof[8]||0;
    document.getElementById('mRevenue').textContent = fmtMoney(revThis*1000000);
    document.getElementById('mProfit').textContent = fmtMoney(profThis*1000000);
    const monthBookings = (db.bookings[currentSpaId]||[]).length;
    document.getElementById('mBookings').textContent = monthBookings;
    const returning = (db.customers[currentSpaId]||[]).filter(c=>c.count>=2).length;
    document.getElementById('mReturning').textContent = returning;

    // tables
    const topBody = document.querySelector('#tblTopServices tbody');
    const byService = {};
    (db.bookings[currentSpaId]||[]).forEach(b=>{byService[b.service]=(byService[b.service]||{count:0, sum:0});byService[b.service].count++;byService[b.service].sum+=b.price;});
    topBody.innerHTML = Object.entries(byService).map(([name,o])=>`<tr><td>${name}</td><td>${o.count}</td><td>${fmtMoney(o.sum)}</td></tr>`).join('')||'<tr><td colspan=3 class="muted">ChÆ°a cÃ³ dá»¯ liá»‡u</td></tr>';

    const perfBody = document.querySelector('#tblStaffPerf tbody');
    perfBody.innerHTML = (db.staff[currentSpaId]||[]).map(s=>`<tr><td>${s.name}</td><td>${s.orders}</td><td>${s.rating.toFixed(1)}</td></tr>`).join('')||'<tr><td colspan=3 class="muted">ChÆ°a cÃ³ dá»¯ liá»‡u</td></tr>';

    // chart
    const ctx = document.getElementById('chartRevenue');
    if(window._chart){window._chart.destroy();}
    window._chart = new Chart(ctx,{type:'bar', data:{labels:stat.months, datasets:[{label:'Doanh thu (triá»‡u)', data:stat.rev, borderWidth:1},{label:'Lá»£i nhuáº­n (triá»‡u)', data:stat.prof, borderWidth:1}]}, options:{responsive:true, scales:{y:{beginAtZero:true}}}});
  }

  function renderServices(){
    const body = document.querySelector('#tblServices tbody');
    const arr = db.services[currentSpaId]||[];
    body.innerHTML = arr.map(s=>`<tr><td>${s.name}</td><td>${s.duration} phÃºt</td><td>${fmtMoney(s.price)}</td><td><button class='btn ghost' onclick='editService(${s.id})'>Sá»­a</button> <button class='btn' style='background:var(--danger);color:#fff' onclick='delService(${s.id})'>XÃ³a</button></td></tr>`).join('');
  }
  function renderStaff(){
    const body = document.querySelector('#tblStaff tbody');
    const arr = db.staff[currentSpaId]||[];
    body.innerHTML = arr.map(s=>`<tr><td>${s.name}</td><td>${s.skills}</td><td>${s.active?'<span class="badge live">Active</span>':'<span class="badge pause">Inactive</span>'}</td><td><button class='btn ghost' onclick='editStaff(${s.id})'>Sá»­a</button> <button class='btn' style='background:var(--danger);color:#fff' onclick='delStaff(${s.id})'>XÃ³a</button></td></tr>`).join('');
  }
  function renderBookings(){
    const body = document.querySelector('#tblBookings tbody');
    const q = document.getElementById('searchBooking').value?.toLowerCase()||'';
    const arr = (db.bookings[currentSpaId]||[]).filter(b=> (b.customer+b.phone).toLowerCase().includes(q));
    body.innerHTML = arr.map(b=>`<tr><td>${b.customer} (${b.phone})</td><td>${b.service}</td><td>${b.time}</td><td>${fmtMoney(b.price)}</td><td>${b.status}</td><td><button class='btn primary' onclick='confirmBooking(${b.id})'>XÃ¡c nháº­n</button> <button class='btn' style='background:var(--warning);color:#fff' onclick='cancelBooking(${b.id})'>Há»§y</button></td></tr>`).join('');
  }
  function renderReviews(){
    const body = document.querySelector('#tblReviews tbody');
    body.innerHTML = (db.reviews[currentSpaId]||[]).map(r=>`<tr><td>${r.name}</td><td>â˜… ${r.rating}</td><td>${r.text}</td><td>${r.date}</td><td><button class='btn ghost' onclick='replyReview(${r.id})'>Tráº£ lá»i</button> <button class='btn' style='background:var(--warning);color:#fff' onclick='reportReview(${r.id})'>BÃ¡o cÃ¡o</button></td></tr>`).join('');
  }
  function renderCustomers(){
    const body = document.querySelector('#tblCustomers tbody');
    body.innerHTML = (db.customers[currentSpaId]||[]).map(c=>`<tr><td>${c.name}</td><td>${c.phone}</td><td>${c.count}</td><td><span class='rank ${c.rank}'>${c.rank}</span></td></tr>`).join('');
  }
  function renderCoupons(){
    const body = document.querySelector('#tblCoupons tbody');
    body.innerHTML = (db.coupons[currentSpaId]||[]).map(c=>`<tr><td>${c.code}</td><td>${c.type}</td><td>${c.value}</td><td>${c.range}</td><td><button class='btn ghost' onclick='editCoupon("${c.code}")'>Sá»­a</button> <button class='btn' style='background:var(--danger);color:#fff' onclick='delCoupon("${c.code}")'>XÃ³a</button></td></tr>`).join('');
  }

  // Calendar simple render (Mon-Sun 8:00-18:00)
  const days = ['CN','T2','T3','T4','T5','T6','T7'];
  function renderCalendar(){
    const cal = document.getElementById('calendar');
    cal.innerHTML = '';
    // header
    cal.insertAdjacentHTML('beforeend', `<div class='cal-head'><div></div>${days.map(d=>`<div>${d}</div>`).join('')}</div>`);
    for(let h=8; h<=18; h++){
      cal.insertAdjacentHTML('beforeend', `<div class='cal-time'>${String(h).padStart(2,'0')}:00</div>${days.map(()=>`<div class='slot'></div>`).join('')}`);
    }
    // demo events from bookings of current spa on T4 10:00 etc.
    const slots = cal.querySelectorAll('.slot');
    const demo = (db.bookings[currentSpaId]||[]);
    if (demo[0]){ const i = 1*7 + 2; slots[i].innerHTML = `<div class='event'>${demo[0].customer}<br/><small>${demo[0].service}</small></div>`; }
  }

  // ======= NAV =======
  document.getElementById('sideNav').addEventListener('click', (e)=>{
    if(e.target.closest('button')){
      const tab = e.target.closest('button').dataset.tab;
      document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
      e.target.closest('button').classList.add('active');
      document.querySelectorAll('[id^=tab-]').forEach(x=>x.style.display='none');
      document.getElementById('tab-'+tab).style.display='block';
    }
  });

  // ======= ACTIONS =======
  spaSelect.addEventListener('change',()=>{currentSpaId=parseInt(spaSelect.value);populateDashboard();renderServices();renderStaff();renderBookings();renderReviews();renderCustomers();renderCoupons();renderCalendar();});
  document.getElementById('btnToggleStatus').onclick = ()=>{const spa=db.spas.find(s=>s.id==currentSpaId); spa.status = spa.status==='active'?'paused':'active'; populateDashboard();};
  document.getElementById('searchBooking').oninput = renderBookings;

  // CRUD stubs (replace with backend)
  window.editService = id=>alert('Sá»­a dá»‹ch vá»¥ #'+id);
  window.delService = id=>{db.services[currentSpaId]= (db.services[currentSpaId]||[]).filter(s=>s.id!==id);renderServices();};
  document.getElementById('btnAddService').onclick = ()=>{const name=prompt('TÃªn dá»‹ch vá»¥?'); if(!name) return; (db.services[currentSpaId]||=[]).push({id:Math.random(),name,duration:60,price:300000}); renderServices();};

  window.editStaff = id=>alert('Sá»­a nhÃ¢n viÃªn #'+id);
  window.delStaff = id=>{db.staff[currentSpaId]= (db.staff[currentSpaId]||[]).filter(s=>s.id!==id);renderStaff();};
  document.getElementById('btnAddStaff').onclick = ()=>{const name=prompt('TÃªn nhÃ¢n viÃªn?'); if(!name) return; (db.staff[currentSpaId]||=[]).push({id:Math.random(),name,skills:'Massage',active:true,rating:4.5,orders:0}); renderStaff();};

  window.confirmBooking = id=>{const b=(db.bookings[currentSpaId]||[]).find(x=>x.id===id); if(b){b.status='confirmed'; renderBookings();}};
  window.cancelBooking = id=>{const b=(db.bookings[currentSpaId]||[]).find(x=>x.id===id); if(b){b.status='cancelled'; renderBookings();}};

  window.replyReview = id=>alert('Tráº£ lá»i review #'+id);
  window.reportReview = id=>alert('BÃ¡o cÃ¡o review #'+id+' -> gá»­i Admin');

  document.getElementById('btnAddCoupon').onclick = ()=>{const code=prompt('MÃ£?'); if(!code) return; (db.coupons[currentSpaId]||=[]).push({code,type:'percent',value:10,range:'Tá»« hÃ´m nay'}); renderCoupons();};
  window.editCoupon = code=>alert('Sá»­a mÃ£ '+code);
  window.delCoupon = code=>{db.coupons[currentSpaId]= (db.coupons[currentSpaId]||[]).filter(c=>c.code!==code); renderCoupons();};

  // Settings
  document.getElementById('btnSaveSpa').onclick = ()=>{const s=db.spas.find(x=>x.id==currentSpaId); s.name=inpSpaName.value; s.address=inpSpaAddr.value; s.phone=inpSpaPhone.value; s.status=selSpaStatus.value==='active'?'active':'paused'; alert('ÄÃ£ lÆ°u & gá»­i thÃ´ng bÃ¡o tá»›i Admin Ä‘á»ƒ duyá»‡t (demo)'); refreshSpaOptions(); populateDashboard();};
  document.getElementById('btnDeleteSpa').onclick = ()=>{if(!confirm('XÃ³a spa hiá»‡n táº¡i?')) return; db.spas = db.spas.filter(s=>s.id!=currentSpaId); currentSpaId = db.spas[0]?.id; refreshSpaOptions(); populateDashboard(); renderServices(); renderStaff(); renderBookings(); renderReviews(); renderCustomers(); renderCoupons(); renderCalendar();};

  // INIT LOAD
  refreshSpaOptions();
  // prefill settings form
  const inpSpaName=document.getElementById('inpSpaName');
  const inpSpaAddr=document.getElementById('inpSpaAddr');
  const inpSpaPhone=document.getElementById('inpSpaPhone');
  const selSpaStatus=document.getElementById('selSpaStatus');
  function syncSettings(){const s=db.spas.find(x=>x.id==currentSpaId); inpSpaName.value=s.name; inpSpaAddr.value=s.address; inpSpaPhone.value=s.phone; selSpaStatus.value=s.status==='active'?'active':'paused';}

  populateDashboard(); renderServices(); renderStaff(); renderBookings(); renderReviews(); renderCustomers(); renderCoupons(); renderCalendar(); syncSettings();
  window.addEventListener('DOMContentLoaded', function() {
  const btnLogout = document.getElementById('btnLogout');
  if (btnLogout) {
    btnLogout.addEventListener('click', function(e) {
      e.preventDefault();
      localStorage.removeItem('auth');
      window.location.href = "index.html";
    });
  }
});
  </script>
</body>
</html>
